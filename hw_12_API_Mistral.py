"""
hw_num: 12
topic: –í –¥–∞–Ω–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ Mistral API –ø–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –ü–æ–ª—É—á–∏—Ç—å API –ö–ª—é—á. –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–æ–≤ Python –∫–æ–¥–∞ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Mistral API
hw_theme:
  - python
  - –û–û–ü
  - Mistral API
  - ai
  - Facade
st_group: python 411
links:
---
[[13 PYTHON411 HW ‚Ññ13]]

# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ üìÉ
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Mistral API —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö (—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏) –∑–∞–ø—Ä–æ—Å–æ–≤.**

## –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
–í –¥–∞–Ω–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ Mistral API –ø–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –ü–æ–ª—É—á–∏—Ç—å API –ö–ª—é—á. –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–æ–≤ Python –∫–æ–¥–∞ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Mistral API:
- `TextRequest` ‚Äì –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤;
- `ImageRequest` ‚Äì –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º;
- `ChatFacade` ‚Äì —Ñ–∞—Å–∞–¥ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∏ —É–¥–æ–±–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–∏—Å—Ç–µ–º–æ–π.

–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∏ –∏—Ö –ª–æ–≥–∏–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–µ–º–Ω–æ–≥–æ –∏–Ω–∞—á–µ. –ì–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã –±—ã–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤, –∏ —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –∫–ª–∞—Å—Å.
### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ü¶æ
- Python
- –†–∞–±–æ—Ç–∞ —Å API (HTTP-–∑–∞–ø—Ä–æ—Å—ã)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ `Base64`)
- –ü—Ä–∏–Ω—Ü–∏–ø—ã –û–û–ü
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Git (–Ω–µ –º–µ–Ω–µ–µ 3 –∫–æ–º–º–∏—Ç–æ–≤)
- –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã

## –ó–∞–¥–∞–Ω–∏–µ üë∑‚Äç‚ôÇÔ∏è

### –û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏



1. **TextRequest**  
   –ö–ª–∞—Å—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API Mistral.

   –ú–µ—Ç–æ–¥—ã:
   - `__init__(self, api_key: str) -> None`  
     –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ —Å API-–∫–ª—é—á–æ–º.
   - `send(self, text: str, model: str) -> dict`  
     –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ú–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON –¥–ª—è API –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç.  
     
   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
   - –ö–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏ API, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ö–∞–Ω–∏–∑–º –∏—Å–∫–ª—é—á–µ–Ω–∏–π.

2. **ImageRequest**  
   –ö–ª–∞—Å—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–∫–ª—é—á–∞—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.

   –ú–µ—Ç–æ–¥—ã:
   - `__init__(self, api_key: str) -> None`  
     –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å API-–∫–ª—é—á–æ–º.
   - `send(self, text: str, image_path: str, model: str) -> dict`  
     –û—Ç–ø—Ä–∞–≤–∫–∞ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.  
     –ó–∞–¥–∞—á–∏ –º–µ—Ç–æ–¥–∞:
     - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏.
     - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç Base64.
     - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ JSON —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
     - –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞.
     
   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
   - –ú–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω) –∏ –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ —Ä–∞–∑–º–µ—Ä–æ–º.

3. **ChatFacade**  
   –§–∞—Å–∞–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —Å `TextRequest` –∏ `ImageRequest`.

   –ú–µ—Ç–æ–¥—ã:
   - `__init__(self, api_key: str) -> None`  
     –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å API-–∫–ª—é—á–æ–º. –°–æ–∑–¥–∞—é—Ç—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä—ã `TextRequest` –∏ `ImageRequest`, –∞ —Ç–∞–∫–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.
   - `select_mode(self) -> int`  
     –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞: 1 ‚Äì —Ç–µ–∫—Å—Ç–æ–≤—ã–π, 2 ‚Äì —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.
   - `select_model(self, mode: int) -> str`  
     –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –∏–∑ —Å–ø–∏—Å–∫–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ä–µ–∂–∏–º—É. –§–∞—Å–∞–¥ –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –º–æ–¥–µ–ª–∏.
   - `load_image(self, image_path: str) -> str`  
     –ú–µ—Ç–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º). –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—É—Ç–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Base64 (–º–æ–∂–µ—Ç –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å—É `ImageRequest`).
   - `ask_question(self, text: str, model: str, image_path: str = None) -> dict`  
     –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞:
     - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ ‚Äì –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –º–µ—Ç–æ–¥—É `send` –∫–ª–∞—Å—Å–∞ `TextRequest`.
     - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–µ–∂–∏–º–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º ‚Äì –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–∏–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä) –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `send` –∫–ª–∞—Å—Å–∞ `ImageRequest`.
     - –ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–ø–∏—Å–∫–∏.
   - `get_history(self) -> list[tuple[str, dict]]`  
     –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤.
   - (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ) `clear_history(self) -> None`  
     –û—á–∏—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π.

>[!info]
>#### –°–ª—É–∂–µ–±–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å API –∑–∞–ø—Ä–æ—Å–∞–º–∏
>- **–¢–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `send` –∏–∑ `TextRequest` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
>- **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å**: –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, –∏—Å–ø—Ä–∞–≤–Ω–æ –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `load_image` –∏ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –µ–≥–æ –≤ –º–µ—Ç–æ–¥ `send` –∫–ª–∞—Å—Å–∞ `ImageRequest`.
>- **–§–∞—Å–∞–¥**: –ö–ª–∞—Å—Å `ChatFacade` –¥–æ–ª–∂–µ–Ω –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –≤—Å–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã —Å API ‚Äî –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞, –º–æ–¥–µ–ª–∏, –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è) –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏.
  
## –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤

| –ö–ª–∞—Å—Å         | –§–∞–π–ª          | –ú–µ—Ç–æ–¥—ã                                                           | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ                          |
| ------------- | ------------- | ---------------------------------------------------------------- | ------------------------------------------------------------------------ | -------------------------------------- |
| `TextRequest` | `mistral_api.py` | `__init__(api_key: str) -> None`                                 | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å API-–∫–ª—é—á–æ–º                                               | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞                   |
|               |               | `send(text: str, model: str) -> dict`                              | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ API                       | –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã                      |
| `ImageRequest`| `mistral_api.py` | `__init__(api_key: str) -> None`                                 | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å API-–∫–ª—é—á–æ–º                                               | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞                   |
|               |               | `send(text: str, image_path: str, model: str) -> dict`              | –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º (—Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Base64)             | –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã                |
| `ChatFacade`  | `mistral_api.py` | `__init__(api_key: str) -> None`                                 | –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ `TextRequest` –∏ `ImageRequest`, –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ | –§–∞—Å–∞–¥ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è               |
|               |               | `select_mode() -> int`                                             | –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞: 1 ‚Äì —Ç–µ–∫—Å—Ç–æ–≤—ã–π, 2 ‚Äì —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º                      | –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞                           |
|               |               | `select_model(mode: int) -> str`                                   | –í—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞                             | –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏                           |
|               |               | `load_image(image_path: str) -> str`                               | –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –µ–≥–æ –≤ Base64                         | –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏                 |
|               |               | `ask_question(text: str, model: str, image_path: str = None) -> dict` | –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏                         | –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ |
|               |               | `get_history() -> list[tuple[str, dict]]`                          | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤                                  | –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏                       |
|               |               | `clear_history() -> None`                                          | –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤                                         | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π                    |

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–∫–∞–∑–∞–Ω–∏—è

1. **–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –í–æ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–∞—Ö –∏ –º–µ—Ç–æ–¥–∞—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤.
   - –î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ docstring –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π.

2. **–†–∞–±–æ—Ç–∞ —Å Git:**
   - –ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 –∫–æ–º–º–∏—Ç–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–æ–º–º–∏—Ç –æ—Ç—Ä–∞–∂–∞–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π —ç—Ç–∞–ø —Ä–∞–±–æ—Ç—ã:
     - –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç ‚Äì –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤.
     - –í—Ç–æ—Ä–æ–π –∫–æ–º–º–∏—Ç ‚Äì —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
     - –¢—Ä–µ—Ç–∏–π –∫–æ–º–º–∏—Ç ‚Äì –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ñ–∞—Å–∞–¥–∞ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏.

3. **–°–∫—Ä–∏–Ω—à–æ—Ç—ã:**
   - –ü–æ–º–∏–º–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Å —É—Å–ø–µ—à–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞).

4. **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
   –ü—Ä–∏–º–µ—Ä –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
   ```python
   if __name__ == "__main__":
       api_key = "your_api_key_here"
       chat = ChatFacade(api_key)
       
       # –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
       mode = chat.select_mode()
       
       # –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏
       model = chat.select_model(mode)
       
       # –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
       image_path = None
       if mode == 2:
           image_path = chat.load_image("path/to/image.jpg")
       
       # –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
       —Ç–µ–∫—Å—Ç_–≤–æ–ø—Ä–æ—Å–∞ = "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–æ–≤–æ—Å—Ç—è—Ö –≤ IT."
       response = chat.ask_question(—Ç–µ–∫—Å—Ç_–≤–æ–ø—Ä–æ—Å–∞, model, image_path)
       
       print("–û—Ç–≤–µ—Ç –æ—Ç API:", response)
       
       # –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
       print("–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:", chat.get_history())
   ```
   –î–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —à–∞–≥–æ–≤: –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞, –º–æ–¥–µ–ª–∏, –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏), –æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤—ã–≤–æ–¥ –∏—Å—Ç–æ—Ä–∏–∏.

>[!warning]
>#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ üëå
>- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤:** –ù–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –æ–ø–∏—Å–∞–Ω–Ω—ã–º–∏.
>- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤:** –ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å API Mistral –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞.
>- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ä–∞–±–æ—Ç–µ —Å API.
>- **–ö–æ–¥ –∏ Git:** –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PEP-8 –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ docstrings. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ –Ω–µ –º–µ–Ω–µ–µ 3 –∫–æ–º–º–∏—Ç–æ–≤.
>- **–°–∫—Ä–∏–Ω—à–æ—Ç—ã:** –ü—Ä–∏–ª–æ–∂–µ–Ω—ã —Å–∫—Ä–∏–Ω—à–æ—Ç—ã, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤.
>- **–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤.
"""


from settings import MISTRAL_API_KEY
from typing import List, Dict, Tuple, Optional
from mistralai import Mistral
import base64
class TextRequest:
    """
    –ö–ª–∞—Å—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API Mistral."
    """
    def __init__(self, api_key: str):
       self.client = Mistral(api_key=api_key)

    def send(self, text:str, model: str) -> dict:
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å.
        """
        try:
            response = self.client.chat.complete(
                model = model,
                messages = [
                    {
                        "role": "user",
                        "content": text,
                    },
                ]
            )
            
            return {"response": response.choices[0].message.content}
        except Exception as e:
            return {"error": str(e)}
        
# text_request = TextRequest(MISTRAL_API_KEY)
# result = text_request.send("–ö—Ç–æ —Ç–∞–∫–æ–π –õ–µ–Ω–∏–Ω?", "mistral-large-latest")
# print("–í–æ–ø—Ä–æ—Å: –ö—Ç–æ —Ç–∞–∫–æ–π –õ–µ–Ω–∏–Ω?")
# print("–û—Ç–≤–µ—Ç:", result["response"])
        
class ImageRequest:
    """
    –ö–ª–∞—Å—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∫ API Mistral.
    """
    def __init__(self, api_key: str):
        self.client = Mistral(api_key=api_key)

    def encode_image(self, image_path: str) -> Optional[str]:
        """–ö–æ–¥–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ base64."""
        try:
            with open(image_path, "rb") as image_file:
                return base64.b64encode(image_file.read()).decode('utf-8')
        except Exception as e:
            print(f"Error: {e}")
            return None
        
    def send(self, text: str, image_path: str) -> dict:
       
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º."""
        print(f"–ù–∞—á–∏–Ω–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {image_path}")
        
        base64_image = self.encode_image(image_path)
        if not base64_image:
            return {"error": "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"}
        
        try:
            messages = [{
                "role": "user",
                "content": [
                    {"type": "text", "text": "–û–ø–∏—à–∏ –¥–µ—Ç–∞–ª—å–Ω–æ, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ"},
                    {"type": "image_url", "image_url": f"data:image/jpeg;base64,{base64_image}"}
                ]
            }]

            response = self.client.chat.complete(
                model="pixtral-12b-2409",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–µ–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
                messages=messages
            )
            return {"response": response.choices[0].message.content}
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
            return {"error": str(e)}
        
# image_request = ImageRequest(MISTRAL_API_KEY)
# image_path = r"C:\Users\User\Desktop\20200224_101333.jpg"

# result = image_request.send("–î–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—à–∏, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ.", image_path=image_path)

# print(result["response"])

class ChatFasade:
    """
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞—Å–∞–¥–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API Mistral.
    """
    def __init__(self, api_key: str) -> None:
        self.text_request = TextRequest(api_key)
        self.image_request = ImageRequest(api_key)
        self.history: List[Tuple[str, dict]] = []
        self.text_models = ["mistral-large-latest"]
        self.image_model = ["pixtral-12b-2409"]

    def select_mode(self) ->int:
        """–í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã —Å API."""
        print("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º:\n1. –¢–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å\n2. –ó–∞–ø—Ä–æ—Å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º")
        while True:
            try:
                mode = int(input("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ä–µ–∂–∏–º–∞ (1 –∏–ª–∏ 2): "))
                if mode in [1, 2]:
                    return mode
            except ValueError:
                pass
            print("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ 1 –∏–ª–∏ 2.")

    def select_model(self, mode: int) -> str:
        """–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞."""
        models = self.text_models if mode == 1 else self.image_model
        print(f"–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏: {', '.join(models)}")
        return models [0]
    

    def ask_question(self, text: str, model: str, image_path: str = None) -> dict:
        """–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏."""
        try:
            if model in self.image_model:
                response = self.image_request.send(text, image_path)
                print("–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —Ä–µ–∂–∏–º–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è")
            else:
                response = self.text_request.send(text, model)

            if isinstance(response, dict) and "response" in response:
                self.history.append((text, response))
                self.save_history_to_file()
                return response
            else:
                return {"response": str(response)}
                
        except Exception as e:
            error_response = {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞: {str(e)}"}
            self.history.append((text, error_response))
            self.save_history_to_file() 
            return {"response": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞: {str(e)}"}
        
    
    def get_history(self) -> List[Tuple[str, dict]]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤."""
        return self.history
    
    def clear_history(self) -> None:
        """–û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤."""
        self.history.clear()

    def save_history_to_file(self, filename="history.txt"):
        with open(filename, "w", encoding="utf-8") as f:
            for question, response in self.history:
                f.write(f"–ó–∞–ø—Ä–æ—Å: {question}\n")
                f.write(f"–û—Ç–≤–µ—Ç: {response.get('response', response.get('error'))}\n\n")
       
def main():
    chat = ChatFasade(MISTRAL_API_KEY)

    while True:
        mode = chat.select_mode()
        model = chat.select_model(mode)

        if mode == 2:
            text = "–û–ø–∏—à–∏ –¥–µ—Ç–∞–ª—å–Ω–æ, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ"
            print("\n–ü—Ä–∏–º–µ—Ä –ø—É—Ç–∏: C:/Users/Pictures/image.jpg")
            image_path = input("–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é: ")
            print(f"–ü—É—Ç—å –ø–æ–ª—É—á–µ–Ω: {image_path}")
        else:
            text = "–†–∞—Å—Å–∫–∞–∂–∏ –∞–Ω–µ–∫–¥–æ—Ç"
            image_path = None

        result = chat.ask_question(text, model, image_path)
        print("\n–û—Ç–≤–µ—Ç:", result.get("response", result.get("error")))


        if input("\n–•–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/n): ").lower() != "y":
            break

        print("\n–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤:")
        for question, response in chat.get_history():
            print(f"\n–ó–∞–ø—Ä–æ—Å: {question}")
            print(f"–û—Ç–≤–µ—Ç: {response.get('response', response.get('error', '–û—à–∏–±–∫–∞'))}")

if __name__ == "__main__":
    main()

__all__ = ['TextRequest', 'ImageRequest', 'ChatFasade']



